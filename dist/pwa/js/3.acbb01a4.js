(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"2fbc":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{attrs:{padding:""}},[a("q-header",{staticClass:"bg-darkl1 text-grey-7"},[a("q-toolbar",[a("q-btn",{attrs:{flat:"",icon:"far fa-arrow-alt-circle-left"},on:{click:function(e){return t.$router.push("/cajas")}}}),a("q-toolbar-title",{staticClass:"text-center"},[t.loadingcash?a("q-spinner",{attrs:{color:"dark",thickness:2}}):a("span",{staticClass:"text-weight-light"},[t._v(" Caja "+t._s(t.idcash))])],1),a("span",[a("span",{staticClass:"text-pink-6"},[t._v(" Smart")]),a("span",{staticClass:"text-white"},[t._v("Park")])])],1)],1),a("div",{staticClass:"row justify-end items-center q-mb-md"},[t.data?[a("q-card",{staticClass:"bg-darkl1 q-ml-md",attrs:{flat:""}},[a("q-card-section",{attrs:{horizontal:""}},[a("q-card-section",[a("div",{staticClass:"text-light-blue-13 text-h4"},[t._v("100")]),a("div",[t._v("operaciones")])]),a("q-separator",{attrs:{vertical:""}}),a("q-card-section",[a("div",{staticClass:"text-light-blue-13 text-h4"},[t._v("$ 100")]),a("div",[t._v("efectivo cobrado")])])],1)],1),t.instance?[a("q-card",{staticClass:"bg-darkl1 q-ml-md text-pink-6",attrs:{flat:""}},[a("q-card-section",{attrs:{horizontal:""}},[a("q-card-section",[a("q-btn",{attrs:{flat:"",round:"",icon:"fas fa-plus",size:"lg"}})],1),a("q-separator",{attrs:{vertical:""}}),a("q-card-section",[a("q-btn",{attrs:{flat:"",round:"",icon:"fas fa-minus",size:"lg"}})],1)],1)],1)]:t._e(),a("q-card",{staticClass:"bg-darkl1 q-ml-md",attrs:{flat:""}},[a("q-card-section",[1==t.data._state?[a("q-btn",{attrs:{flat:"",round:"",color:"green-13",icon:"far fa-play-circle",size:"lg"},on:{click:function(e){return t.initOpening()}}})]:t._e(),2==t.data._state?[t.recycleOpening(t.opening,t.cut)?a("q-btn",{attrs:{flat:"",round:"",color:"orange-10",icon:"fas fa-play-circle",loading:t.wndOpening.reopen,disable:t.wndOpening.reopen,size:"lg"},on:{click:function(e){return t.reactiveOpening(t.opening,t.idcash)}}}):a("q-btn",{attrs:{flat:"",round:"",color:"green-13",icon:"far fa-play-circle",size:"lg"},on:{click:function(e){return t.initOpening(t.idcash)}}})]:t._e(),3==t.data._state?[a("q-btn",{attrs:{flat:"",round:"",color:"red",icon:"fas fa-cut",size:"lg"},on:{click:function(e){return t.initCut(t.idcash)}}})]:t._e()],2)],1)]:t._e()],2),a("q-card",{staticClass:"bg-darkl1"},[a("q-card-section",{staticClass:"row justify-between items-center"},[a("div",[a("q-icon",{attrs:{name:"fas fa-history"}}),t._v(" Historico")],1),a("div",[a("q-select",{staticStyle:{width:"100px"},attrs:{borderless:"",dense:"",dark:"",color:"light-blue-13",options:[{label:"Semana",value:"w"},{label:"Mes",value:"m"},{label:"AÃ±o",value:"y"}]},on:{input:t.getHistoric},model:{value:t.histview,callback:function(e){t.histview=e},expression:"histview"}})],1)]),a("q-separator"),a("q-card-section",[t.historic?a("div",[a("q-table",{staticClass:"_thsticky",attrs:{dark:"",flat:"","card-class":"bg-none text-grey-6",data:t.historic,columns:t.columnsHist,"row-key":"opening","table-header-class":"text-light-blue-13",separator:"none"},scopedSlots:t._u([{key:"body",fn:function(e){return[a("q-tr",{staticStyle:{},attrs:{props:e}},[a("q-td",{key:"opening",attrs:{props:e}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.row.opening)+"\n\t\t\t\t\t\t\t")]),a("q-td",{key:"start",attrs:{props:e}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.row.starts)+"\n\t\t\t\t\t\t\t")]),a("q-td",{key:"end",attrs:{props:e}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.row.ends)+"\n\t\t\t\t\t\t\t")]),a("q-td",{key:"sparkings",attrs:{props:e}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.row.parkings.length)+"\n\t\t\t\t\t\t\t")]),a("q-td",{key:"spayments",attrs:{props:e}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.pksPayments(e.row.parkings))+"\n\t\t\t\t\t\t\t")]),a("q-td",{key:"sarchiveds",attrs:{props:e}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.pksArchiveds(e.row.parkings))+"\n\t\t\t\t\t\t\t")]),a("q-td",{key:"actions",attrs:{props:e}},[a("q-btn",{attrs:{dense:"",flat:"",color:"light-blue-13",size:"sm",icon:"open_in_new"}})],1)],1)]}}])})],1):a("q-spinner",{attrs:{color:"grey-7",size:"2em",thickness:2}})],1),a("q-separator"),a("q-card-section",{attrs:{horizontal:""}},[a("q-card-section",[a("div",[t._v("Ultima Apertura: ")]),a("div",[t._v(" "+t._s(t.opening?t.humantime(t.opening.init):"---")+" ")])]),a("q-separator",{attrs:{vertical:""}}),a("q-card-section",[a("div",[t._v("Ultima Asignacion:")]),a("div",[t._v(" "+t._s(t.opening?t.opening.usbynick:"---")+" ")])]),a("q-separator",{attrs:{vertical:""}}),a("q-card-section",[a("div",[t._v("Ultimo Corte:")]),a("div",[t._v(" "+t._s(t.cut?t.humantime(t.cut.makeit):"---")+" ")])])],1)],1),a("q-dialog",{model:{value:t.wndOpening.state,callback:function(e){t.$set(t.wndOpening,"state",e)},expression:"wndOpening.state"}},[a("q-card",[a("q-toolbar",{staticClass:"bg-white text-dark"},[a("q-toolbar-title",[a("span",{staticClass:"text-weight-light"},[t._v(" Apertura de Caja "+t._s(t.idcash))])])],1),a("q-card-section",[a("q-select",{attrs:{color:"dark",options:t.cashiersavls,"stack-label":"",label:"Asignar a:"},model:{value:t.userforassign,callback:function(e){t.userforassign=e},expression:"userforassign"}})],1),a("q-card-section",[a("div",{staticClass:"row"},[a("q-markup-table",{attrs:{flat:""}},t._l(t.bills,(function(e,s){return a("tr",{key:s+"_bill",staticClass:"text-indigo-5"},[a("td",[a("q-input",{attrs:{color:"dark",type:"number",min:"0","stack-label":"",label:"$ "+String(e.value)},model:{value:e.model,callback:function(a){t.$set(e,"model",a)},expression:"bill.model"}})],1)])})),0),a("q-markup-table",{attrs:{flat:""}},t._l(t.coins,(function(e,s){return a("tr",{key:s+"_coin"},[a("td",[a("q-input",{attrs:{color:"dark",type:"number",min:"0","stack-label":"",label:"$ "+String(e.value)},model:{value:e.model,callback:function(a){t.$set(e,"model",a)},expression:"coin.model"}})],1)])})),0)],1)]),t.totalCurrs?a("q-card-actions",{attrs:{align:"center"}}):t._e()],1)],1)],1)},n=[],i=(a("13d5"),a("5948")),r=a("bd4c"),o={data(){return{histview:{label:"Semana",value:"w"},loadingcash:!0,idcash:null,data:null,cashiersdb:null,denomsdb:null,userforassign:{value:null,label:"Seleccione"},cashstates:{1:"Nueva/disponible para apertura",2:"Disponible para apertura",3:"En uso (cobrando)"},opening:null,cut:null,wndOpening:{state:!1,cash:null,opening:!1,reopen:!1},instance:null,historic:null,columnsHist:[{name:"opening",required:!0,label:"Apertura",align:"left",field:t=>t.opening,sortable:!0},{name:"start",align:"center",label:"Inicio",field:"starts",sortable:!0},{name:"end",align:"center",label:"Corte",field:"ends",sortable:!0},{name:"sparkings",align:"center",label:"Entradas",field:"parkings",sortable:!0},{name:"spayments",align:"center",label:"Cobros",field:"parkings",sortable:!0},{name:"sarchiveds",align:"center",label:"Archivados",field:"parkings",sortable:!0},{name:"actions",align:"center"}]}},mounted(){this.getHistoric()},beforeMount(){this.idcash=this.$route.params.id,console.log(this.idcash),console.log(`%cMontando Caja ${this.idcash}`,"font-size:2em");let t={apikey:this.apikey,cashdesk:{id:this.idcash}};i["a"].shield(t).then((t=>{let e=t.data;console.log(e),e.shield?(this.loadingcash=!1,this.idcash=e.cash.id,this.opening=e.openandcut.opening,this.cut=e.openandcut.cut,this.denomsdb=e.currencies,this.cashiersdb=e.cashiers,this.data=e.cash,this.instance=e.instance):this.$router.push("/cajas")})).catch((t=>{console.log(t)}))},methods:{reactiveOpening(t,e){console.log(t),this.wndOpening.reopen=!0;let a={apikey:this.apikey,opening:t};i["a"].reactiveOpening(a).then((t=>{let a=t.data;console.log(a),this.wndOpening.reopen=!1;let s=this.cashdesks.findIndex((t=>t.id==e));this.cashdesks[s]._state=3,this.cashdesks[s].cut=null})).catch((t=>{console.log(t)}))},initOpening(t){this.wndOpening.state=!0},initCut(t){this.wndCut.cash=this.cashdesks[t],this.wndCut.state=!0},getHistoric(){let t={apikey:this.apikey,histview:this.histview,idcash:this.idcash};i["a"].historic(t).then((t=>{let e=t.data;console.log(e),this.historic=e.openings})).catch((t=>{console.log(resp)}))}},computed:{apikey(){return this.$store.state.account.apikey},recycleOpening(){return(t,e)=>{if(t&&e){let e=Date.now(),a=Date.parse(t.init),s=r["a"].getDateDiff(e,a,"days");return 0==s}return!1}},cashiersavls(){if(this.cashiersdb)return this.cashiersdb.filter((t=>!t.usingcash)).map((t=>({value:t.accid,label:`${t.fnames} ${t.lnames} (${t.nick})`})))},bills(){if(this.denomsdb)return this.denomsdb.filter((t=>1==t.type))},coins(){if(this.denomsdb)return this.denomsdb.filter((t=>2==t.type))},totalCurrs(){if(this.denomsdb){let t=this.coins.map((t=>t.value*t.model)).reduce(((t,e)=>t+e))+this.bills.map((t=>t.value*t.model)).reduce(((t,e)=>t+e));return t}return 0},humantime(){return t=>{let e=Date.now(),a=Date.parse(t),s=r["a"].getDateDiff(e,a,"days");switch(s){case 1:return"Ayer a las "+r["a"].formatDate(a,"hh:mm a");case 0:return"Hoy a las "+r["a"].formatDate(a,"hh:mm a");default:return`Hace ${s} dias, a las `+r["a"].formatDate(a,"hh:mm a")}return s}},pksPayments(){return t=>t.filter((t=>3==t.state)).length},pksArchiveds(){return t=>t.filter((t=>6==t.state)).length}}},l=o,c=(a("7ad7"),a("2877")),d=a("9989"),p=a("e359"),u=a("65c6"),h=a("9c40"),g=a("6ac5"),b=a("0d59"),f=a("f09f"),m=a("a370"),k=a("eb85"),v=a("0016"),q=a("ddd8"),_=a("eaac"),y=a("bd08"),w=a("db86"),C=a("24e8"),x=a("2bb1"),O=a("27f9"),z=a("4b7e"),Q=a("eebe"),$=a.n(Q),D=Object(c["a"])(l,s,n,!1,null,null,null);e["default"]=D.exports;$()(D,"components",{QPage:d["a"],QHeader:p["a"],QToolbar:u["a"],QBtn:h["a"],QToolbarTitle:g["a"],QSpinner:b["a"],QCard:f["a"],QCardSection:m["a"],QSeparator:k["a"],QIcon:v["a"],QSelect:q["a"],QTable:_["a"],QTr:y["a"],QTd:w["a"],QDialog:C["a"],QMarkupTable:x["a"],QInput:O["a"],QCardActions:z["a"]})},5948:function(t,e,a){"use strict";var s=a("5671");e["a"]={index(t){return console.log("%cIndexando Cashdesks...","font-size:2em; color:gold;"),console.log(t),s["a"].post("cashdesks/index",t).then((t=>(console.log(t.data),t.data))).catch((t=>{console.log("Hay un error importante"),console.log(t)}))},newOpening(t){return console.log("%cApertudando Caja...","font-size:2em; color:gold;"),s["a"].post("cashdesks/opening",t)},reactiveOpening(t){return console.log("%cRepertudando Caja...","font-size:2em; color:gold;"),console.log(t),s["a"].post("cashdesks/reactive",t)},makeCut(t){return console.log("%cHaciendo Corte...","font-size:2em; color:gold;"),s["a"].post("cashdesks/cut",t)},shield(t){return console.log("%cCargando Dashboard de caja...","font-size:2em; color:gold;"),console.log(t),s["a"].post("cashdesks/shield",t)},historic(t){return console.log("%cCargando Historico","font-size:2em; color:purple;"),console.log(t),s["a"].post("cashdesks/historic",t)}}},"757c":function(t,e,a){},"7ad7":function(t,e,a){"use strict";a("757c")}}]);