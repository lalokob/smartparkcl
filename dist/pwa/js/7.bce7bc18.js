(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"2fbc":function(a,e,t){"use strict";t.r(e);var s=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("q-page",{attrs:{padding:""}},[t("q-header",{staticClass:"text-white bg-smoke"},[t("q-toolbar",[t("q-btn",{attrs:{flat:"",icon:"far fa-arrow-alt-circle-left"},on:{click:function(e){return a.$router.push("/cajas")}}}),t("q-toolbar-title",{staticClass:"text-center"},[a.loadingcash?t("q-spinner",{attrs:{color:"dark",thickness:2}}):t("span",{staticClass:"text-weight-light"},[a._v(" Caja "+a._s(a.idcash))])],1)],1)],1),t("q-card",{staticClass:"text-weight-light"},[t("q-toolbar",[a.data?[t("span",[a._v(" Estado: "+a._s(a.cashstates[a.data._state])+" ")]),t("q-space"),1==a.data._state?[t("q-btn",{attrs:{flat:"",round:"",color:"primary",icon:"far fa-play-circle"},on:{click:function(e){return a.initOpening()}}})]:a._e(),2==a.data._state?[a.recycleOpening(a.opening,a.cut)?t("q-btn",{attrs:{flat:"",round:"",color:"orange-10",icon:"fas fa-play-circle",loading:a.wndOpening.reopen,disable:a.wndOpening.reopen},on:{click:function(e){return a.reactiveOpening(a.opening,a.idcash)}}}):t("q-btn",{attrs:{flat:"",round:"",color:"primary",icon:"far fa-play-circle"},on:{click:function(e){return a.initOpening(a.idcash)}}})]:a._e(),3==a.data._state?[t("q-btn",{attrs:{flat:"",round:"",color:"red",icon:"fas fa-cut"},on:{click:function(e){return a.initCut(a.idcash)}}})]:a._e()]:a._e()],2),t("q-separator"),t("q-card-section",{attrs:{horizontal:""}},[t("q-card-section",[t("div",{staticClass:"column"},[t("span",[a._v(" Aperturas: 100 ")]),t("span",[a._v(" Cortes: 100 ")]),t("span",[a._v(" Operaciones: 100 ")])])]),t("q-separator",{attrs:{vertical:""}}),t("q-card-section",[t("div",{staticClass:"column"},[t("div",[a._v(" Ultima Apertura: "),t("span",[a._v(" "+a._s(a.opening?a.humantime(a.opening.init):"---")+" ")])]),t("div",[a._v(" Asignacion: "),t("span",[a._v(" "+a._s(a.opening?a.opening.usbynick:"---")+" ")])]),t("div",[a._v(" Ultimo Corte: "),t("span",[a._v(" "+a._s(a.cut?a.humantime(a.cut.makeit):"---")+" ")])])])]),t("q-separator",{attrs:{vertical:""}})],1)],1),t("q-dialog",{model:{value:a.wndOpening.state,callback:function(e){a.$set(a.wndOpening,"state",e)},expression:"wndOpening.state"}},[t("q-card",[t("q-toolbar",{staticClass:"bg-white text-dark"},[t("q-toolbar-title",[t("span",{staticClass:"text-weight-light"},[a._v(" Apertura de Caja "+a._s(a.idcash))])])],1),t("q-card-section",[t("q-select",{attrs:{color:"dark",options:a.cashiersavls,"stack-label":"",label:"Asignar a:"},model:{value:a.userforassign,callback:function(e){a.userforassign=e},expression:"userforassign"}})],1),t("q-card-section",[t("div",{staticClass:"row"},[t("q-markup-table",{attrs:{flat:""}},a._l(a.bills,(function(e,s){return t("tr",{key:s+"_bill",staticClass:"text-indigo-5"},[t("td",[t("q-input",{attrs:{color:"dark",type:"number",min:"0","stack-label":"",label:"$ "+String(e.value)},model:{value:e.model,callback:function(t){a.$set(e,"model",t)},expression:"bill.model"}})],1)])})),0),t("q-markup-table",{attrs:{flat:""}},a._l(a.coins,(function(e,s){return t("tr",{key:s+"_coin"},[t("td",[t("q-input",{attrs:{color:"dark",type:"number",min:"0","stack-label":"",label:"$ "+String(e.value)},model:{value:e.model,callback:function(t){a.$set(e,"model",t)},expression:"coin.model"}})],1)])})),0)],1)]),a.totalCurrs?t("q-card-actions",{attrs:{align:"center"}}):a._e()],1)],1)],1)},n=[],i=t("5948"),o=t("bd4c"),r={data(){return{loadingcash:!0,idcash:null,data:null,cashiersdb:null,denomsdb:null,userforassign:{value:null,label:"Seleccione"},cashstates:{1:"Nueva/disponible para apertura",2:"Disponible para apertura",3:"En uso (cobrando)"},opening:null,cut:null,wndOpening:{state:!1,cash:null,opening:!1,reopen:!1}}},beforeMount(){this.idcash=this.$route.params.id,console.log(this.idcash),console.log("%cMontando Caja "+this.idcash,"font-size:2em");let a={apikey:this.apikey,cashdesk:{id:this.idcash}};i["a"].shield(a).then(a=>{let e=a.data;console.log(e),e.shield?(this.loadingcash=!1,this.idcash=e.cash.id,this.opening=e.openandcut.opening,this.cut=e.openandcut.cut,this.denomsdb=e.currencies,this.cashiersdb=e.cashiers,this.data=e.cash):this.$router.push("/cajas")}).catch(a=>{console.log(a)})},methods:{reactiveOpening(a,e){console.log(a),this.wndOpening.reopen=!0;let t={apikey:this.apikey,opening:a};i["a"].reactiveOpening(t).then(a=>{let t=a.data;console.log(t),this.wndOpening.reopen=!1;let s=this.cashdesks.findIndex(a=>a.id==e);this.cashdesks[s]._state=3,this.cashdesks[s].cut=null}).catch(a=>{console.log(a)})},initOpening(a){this.wndOpening.state=!0},initCut(a){this.wndCut.cash=this.cashdesks[a],this.wndCut.state=!0}},computed:{apikey(){return this.$store.state.account.apikey},recycleOpening(){return(a,e)=>{if(a&&e){let e=Date.now(),t=Date.parse(a.init),s=o["a"].getDateDiff(e,t,"days");return 0==s}return!1}},cashiersavls(){if(this.cashiersdb)return this.cashiersdb.filter(a=>!a.usingcash).map(a=>({value:a.accid,label:`${a.fnames} ${a.lnames} (${a.nick})`}))},bills(){if(this.denomsdb)return this.denomsdb.filter(a=>1==a.type)},coins(){if(this.denomsdb)return this.denomsdb.filter(a=>2==a.type)},totalCurrs(){if(this.denomsdb){let a=this.coins.map(a=>a.value*a.model).reduce((a,e)=>a+e)+this.bills.map(a=>a.value*a.model).reduce((a,e)=>a+e);return a}return 0},humantime(){return a=>{let e=Date.now(),t=Date.parse(a),s=o["a"].getDateDiff(e,t,"days");switch(s){case 1:return"Ayer a las "+o["a"].formatDate(t,"hh:mm a");case 0:return"Hoy a las "+o["a"].formatDate(t,"hh:mm a");default:return`Hace ${s} dias, a las `+o["a"].formatDate(t,"hh:mm a")}return s}}}},l=r,c=t("2877"),d=t("9989"),u=t("e359"),p=t("65c6"),h=t("9c40"),g=t("6ac5"),f=t("0d59"),m=t("f09f"),b=t("2c91"),k=t("eb85"),v=t("a370"),_=t("24e8"),q=t("ddd8"),C=t("2bb1"),w=t("27f9"),y=t("4b7e"),O=t("eebe"),x=t.n(O),Q=Object(c["a"])(l,s,n,!1,null,null,null);e["default"]=Q.exports;x()(Q,"components",{QPage:d["a"],QHeader:u["a"],QToolbar:p["a"],QBtn:h["a"],QToolbarTitle:g["a"],QSpinner:f["a"],QCard:m["a"],QSpace:b["a"],QSeparator:k["a"],QCardSection:v["a"],QDialog:_["a"],QSelect:q["a"],QMarkupTable:C["a"],QInput:w["a"],QCardActions:y["a"]})},5948:function(a,e,t){"use strict";var s=t("5671");e["a"]={index(a){return console.log("%cIndexando Cashdesks...","font-size:2em; color:gold;"),console.log(a),s["a"].post("cashdesks/index",a).then(a=>(console.log(a.data),a.data)).catch(a=>{console.log("Hay un error importante"),console.log(a)})},newOpening(a){return console.log("%cApertudando Caja...","font-size:2em; color:gold;"),s["a"].post("cashdesks/opening",a)},reactiveOpening(a){return console.log("%cRepertudando Caja...","font-size:2em; color:gold;"),console.log(a),s["a"].post("cashdesks/reactive",a)},makeCut(a){return console.log("%cHaciendo Corte...","font-size:2em; color:gold;"),s["a"].post("cashdesks/cut",a)},shield(a){return console.log("%cCargando Dashboard de caja...","font-size:2em; color:gold;"),console.log(a),s["a"].post("cashdesks/shield",a)}}}}]);