(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"05a7":function(t,e,s){"use strict";s("3d85")},"3d85":function(t,e,s){},5948:function(t,e,s){"use strict";var a=s("5671");e["a"]={index(t){return console.log("%cIndexando Cashdesks...","font-size:2em; color:gold;"),console.log(t),a["a"].post("cashdesks/index",t).then((t=>(console.log(t.data),t.data))).catch((t=>{console.log("Hay un error importante"),console.log(t)}))},newOpening(t){return console.log("%cApertudando Caja...","font-size:2em; color:gold;"),a["a"].post("cashdesks/opening",t)},reactiveOpening(t){return console.log("%cRepertudando Caja...","font-size:2em; color:gold;"),console.log(t),a["a"].post("cashdesks/reactive",t)},makeCut(t){return console.log("%cHaciendo Corte...","font-size:2em; color:gold;"),a["a"].post("cashdesks/cut",t)},shield(t){return console.log("%cCargando Dashboard de caja...","font-size:2em; color:gold;"),console.log(t),a["a"].post("cashdesks/shield",t)},historic(t){return console.log("%cCargando Historico","font-size:2em; color:purple;"),console.log(t),a["a"].post("cashdesks/historic",t)}}},b02b:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{staticClass:"row items-center justify-center bg-mgradient"},[s("div",{staticClass:"row q-pt-md q-pl-md"},[t.cashloading?s("q-spinner",{attrs:{color:"dark",size:"3em",thickness:2}}):t._e(),t._l(t.cashdesks,(function(e,a){return s("q-card",{key:a,staticClass:"q-mr-md q-mb-md bg-darkl1",attrs:{flat:"",bordered:""}},[s("q-card-section",{attrs:{horizontal:""}},[1==e._state?[s("q-card-section",{staticClass:"column justify-center"},[s("div",{staticClass:"text-h6"},[t._v("Caja "+t._s(e.id))]),s("div",[t._v(t._s(t.cashstates[e._state]))])]),s("q-separator",{attrs:{vertical:""}}),1==t.user.rolid?s("q-card-actions",{staticClass:"justify-around q-px-md",attrs:{vertical:""}},[s("q-btn",{attrs:{flat:"",round:"",color:"green-13",icon:"fas fa-external-link-alt"},on:{click:function(s){return t.$router.push("cajas/"+e.id)}}}),s("q-btn",{attrs:{flat:"",round:"",color:"green-13",icon:"far fa-play-circle"},on:{click:function(e){return t.initOpening(a)}}})],1):t._e()]:t._e(),2==e._state?[s("q-card-section",{staticClass:"column justify-center"},[s("div",[s("span",{staticClass:"text-h6 text-light-blue-13"},[t._v(" Caja "+t._s(e.id)+" ")]),s("span",[t._v(t._s(t.cashstates[e._state]))])]),s("div",[t._v("Ultima apertura: "+t._s(t.humantime(e.opening.init))+", "+t._s(e.opening.usbynames)+" "+t._s(e.opening.usbylnames))]),s("div",[t._v("Asignacion: "+t._s(e.opening.ustonames)+" "+t._s(e.opening.ustolnames))]),s("div",[t._v("Ultimo corte: "+t._s(t.humantime(e.cut.makeit))+", "+t._s(e.cut.fnames)+" "+t._s(e.cut.lnames))])]),s("q-separator",{attrs:{vertical:""}}),1==t.user.rolid?s("q-card-actions",{staticClass:"justify-around q-px-md",attrs:{vertical:""}},[s("q-btn",{attrs:{flat:"",round:"",color:"green-13",icon:"fas fa-external-link-alt"},on:{click:function(s){return t.$router.push("cajas/"+e.id)}}}),t.recycleOpening(e.opening,e.cut)?s("q-btn",{attrs:{flat:"",round:"",color:"orange-10",icon:"fas fa-play-circle",loading:t.wndOpening.reopen,disable:t.wndOpening.reopen},on:{click:function(s){return t.reactiveOpening(e.opening,e.id)}}}):s("q-btn",{attrs:{flat:"",round:"",color:"green-13",icon:"far fa-play-circle"},on:{click:function(e){return t.initOpening(a)}}})],1):t._e()]:t._e(),3==e._state?[s("q-card-section",{staticClass:"column justify-center"},[s("div",[s("span",{staticClass:"text-h6 text-light-blue-13"},[t._v(" Caja "+t._s(e.id)+" ")]),t._v(": "),s("span",[t._v(t._s(t.cashstates[e._state]))])]),s("div",[t._v("Ultima Apertura: "+t._s(t.humantime(e.opening.init))+", "+t._s(e.opening.usbynames)+" "+t._s(e.opening.usbylnames))]),s("div",[t._v("Ultima Asignacion: "+t._s(e.opening.ustonames)+" "+t._s(e.opening.ustolnames)+" ")]),e.cut?s("div",[t._v("Corte: "+t._s(t.humantime(e.cut.makeit))+", "+t._s(e.cut.fnames)+" "+t._s(e.cut.lnames))]):t._e()]),s("q-separator",{attrs:{vertical:""}}),1==t.user.rolid?s("q-card-actions",{staticClass:"justify-around q-px-md",attrs:{vertical:""}},[s("q-btn",{attrs:{flat:"",round:"",color:"green-13",icon:"fas fa-external-link-alt"},on:{click:function(s){return t.$router.push("cajas/"+e.id)}}}),s("q-btn",{attrs:{flat:"",round:"",color:"green-13",icon:"fas fa-cut"},on:{click:function(e){return t.initCut(a)}}})],1):t._e(),2==t.user.rolid?s("q-card-actions",{staticClass:"justify-around q-px-md",attrs:{vertical:""}},[s("q-btn",{attrs:{flat:"",round:"",color:"green-13",icon:"fas fa-cut"},on:{click:function(e){return t.initCut(a)}}})],1):t._e()]:t._e()],2)],1)}))],2),s("q-dialog",{model:{value:t.wndOpening.state,callback:function(e){t.$set(t.wndOpening,"state",e)},expression:"wndOpening.state"}},[s("q-card",[s("q-toolbar",{staticClass:"bg-white text-dark"},[s("q-toolbar-title",[s("span",{staticClass:"text-weight-light"},[t._v(" Apertura de Caja "+t._s(t.wndOpening.cash?t.wndOpening.cash.id:""))])])],1),s("q-card-section",[s("q-select",{attrs:{color:"dark",options:t.cashiersavls,"stack-label":"",label:"Asignar a:"},model:{value:t.userforassign,callback:function(e){t.userforassign=e},expression:"userforassign"}})],1),s("q-card-section",[s("div",{staticClass:"row"},[s("q-markup-table",{attrs:{flat:""}},t._l(t.bills,(function(e,a){return s("tr",{key:a+"_bill",staticClass:"text-indigo-5"},[s("td",[s("q-input",{attrs:{color:"dark",type:"number",min:"0","stack-label":"",label:"$ "+String(e.value)},model:{value:e.model,callback:function(s){t.$set(e,"model",s)},expression:"bill.model"}})],1)])})),0),s("q-markup-table",{attrs:{flat:""}},t._l(t.coins,(function(e,a){return s("tr",{key:a+"_coin"},[s("td",[s("q-input",{attrs:{color:"dark",type:"number",min:"0","stack-label":"",label:"$ "+String(e.value)},model:{value:e.model,callback:function(s){t.$set(e,"model",s)},expression:"coin.model"}})],1)])})),0)],1)]),t.totalCurrs?s("q-card-actions",{attrs:{align:"center"}},[s("q-btn",{attrs:{color:"dark",loading:t.wndOpening.opening},on:{click:t.makeOpening}},[t._v("Iniciar con $"+t._s(t.totalCurrs))])],1):t._e()],1)],1),s("q-dialog",{model:{value:t.wndCut.state,callback:function(e){t.$set(t.wndCut,"state",e)},expression:"wndCut.state"}},[s("q-card",[s("q-toolbar",{staticClass:"bg-white text-dark"},[s("q-toolbar-title",[s("span",{staticClass:"text-weight-light"},[t._v(" Corte de Caja "+t._s(t.wndCut.cash?t.wndCut.cash.id:""))])])],1),s("q-card-section",[s("div",{staticClass:"row"},[s("q-markup-table",{attrs:{flat:""}},t._l(t.bills,(function(e,a){return s("tr",{key:a+"_bill",staticClass:"text-indigo-5"},[s("td",[s("q-input",{attrs:{color:"dark",type:"number",min:"0","stack-label":"",label:"$ "+String(e.value)},model:{value:e.model,callback:function(s){t.$set(e,"model",s)},expression:"bill.model"}})],1)])})),0),s("q-markup-table",{attrs:{flat:""}},t._l(t.coins,(function(e,a){return s("tr",{key:a+"_coin"},[s("td",[s("q-input",{attrs:{color:"dark",type:"number",min:"0","stack-label":"",label:"$ "+String(e.value)},model:{value:e.model,callback:function(s){t.$set(e,"model",s)},expression:"coin.model"}})],1)])})),0)],1)]),t.totalCurrs?s("q-card-actions",{attrs:{align:"center"}},[s("q-btn",{attrs:{color:"dark",loading:t.wndCut.cuting},on:{click:t.makeCut}},[t._v("Cerrar caja con: $"+t._s(t.totalCurrs))])],1):t._e()],1)],1)],1)},n=[],i=(s("13d5"),s("e6cf"),s("5948")),o=s("bd4c"),r={data(){return{cashloading:!0,cashdesks:[],cashiersdb:null,denomsdb:null,userforassign:{value:null,label:"Seleccione"},wndCut:{state:!1,cash:null,cuting:!1},wndOpening:{state:!1,cash:null,opening:!1,reopen:!1},cashstates:{1:"Nueva/disponible para apertura",2:"Disponible para apertura",3:"En uso (cobrando)"}}},beforeMount(){this.index()},methods:{async index(){let t=await i["a"].index({apikey:this.apikey});this.cashdesks=t.cashdesks,this.denomsdb=t.currencies.map((t=>(t.model=0,t))),this.cashiersdb=t.cashiers,this.cashloading=!1},initCut(t){this.wndCut.cash=this.cashdesks[t],this.wndCut.state=!0},initOpening(t){this.wndOpening.cash=this.cashdesks[t],this.wndOpening.state=!0},reactiveOpening(t,e){console.log(t),this.wndOpening.reopen=!0;let s={apikey:this.apikey,opening:t};i["a"].reactiveOpening(s).then((t=>{let s=t.data;console.log(s),this.wndOpening.reopen=!1;let a=this.cashdesks.findIndex((t=>t.id==e));this.cashdesks[a]._state=3,this.cashdesks[a].cut=null})).catch((t=>{console.log(t)}))},resetwndCut(){this.wndCut.cash=null,this.wndCut.state=!1,this.wndCut.cuting=!1},resetwndOpening(){this.wndOpening.cash=null,this.wndOpening.state=!1,this.wndOpening.opening=!1},makeCut(){console.log("cutcash starts");let t=this.denomsdb.map((t=>({id:t.id,cant:parseInt(t.model)}))),e={apikey:this.apikey,cashdesk:{id:this.wndCut.cash.id,denoms:t,notes:""}};this.wndCut.cuting=!0,i["a"].makeCut(e).then((t=>{let e=t.data;console.log(e),this.$q.notify({color:"positive",message:`Corte ${e.resume.cut.id} concretado!!`,icon:"done"});let s=this.cashdesks.findIndex((t=>t.id==this.wndCut.cash.id));this.cashdesks[s]._state=2,this.cashdesks[s].cut=e.resume.openandcut.cut,this.resetwndCut()})).catch((t=>{console.log(t)}))},makeOpening(){if(this.userforassign.value){console.log("opening starts");let t=this.denomsdb.map((t=>({id:t.id,cant:parseInt(t.model)})));console.log(this.wndOpening.cash.id);let e={apikey:this.apikey,cashdesk:{id:this.wndOpening.cash.id,denoms:t,assignto:this.userforassign.value,notes:""}};console.log(e),this.wndOpening.opening=!0,i["a"].newOpening(e).then((t=>{let e=t.data;if(console.log(e),e){this.wndOpening.state=!1;let t=this.cashdesks.findIndex((t=>t.id==this.wndOpening.cash.id));this.cashdesks[t].opening=e.rset.opening,this.cashdesks[t]._state=3,console.log(this.cashdesks[t]),this.$q.notify({color:"positive",message:`Listo!! (${e.rset.openid})`,icon:"done"}),this.resetwndOpening()}})).catch((t=>{console.log(t)}))}else this.$q.notify({color:"warning",message:"Debes seleccionar un cajero",icon:"error_outline"})},entry(t){console.log(`navegar en caja ${t}`)}},computed:{recycleOpening(){return(t,e)=>{if(t&&e){let e=Date.now(),s=Date.parse(t.init),a=o["a"].getDateDiff(e,s,"days");return 0==a}return!1}},humantime(){return t=>{let e=Date.now(),s=Date.parse(t),a=o["a"].getDateDiff(e,s,"days");switch(a){case 1:return"Ayer a las "+o["a"].formatDate(s,"hh:mm a");case 0:return"Hoy a las "+o["a"].formatDate(s,"hh:mm a");default:return`Hace ${a} dias, a las `+o["a"].formatDate(s,"hh:mm a")}return a}},apikey(){return this.$store.state.account.apikey},bills(){if(this.denomsdb)return this.denomsdb.filter((t=>1==t.type))},coins(){if(this.denomsdb)return this.denomsdb.filter((t=>2==t.type))},totalCurrs(){if(this.denomsdb){let t=this.coins.map((t=>t.value*t.model)).reduce(((t,e)=>t+e))+this.bills.map((t=>t.value*t.model)).reduce(((t,e)=>t+e));return t}return 0},cashiersavls(){if(this.cashiersdb)return this.cashiersdb.filter((t=>!t.usingcash)).map((t=>({value:t.accid,label:`${t.fnames} ${t.lnames} (${t.nick})`})))},user(){return this.$store.state.account.user}}},c=r,l=(s("05a7"),s("2877")),d=s("9989"),u=s("0d59"),p=s("f09f"),h=s("a370"),g=s("eb85"),m=s("4b7e"),f=s("9c40"),b=s("24e8"),k=s("65c6"),_=s("6ac5"),v=s("ddd8"),C=s("2bb1"),w=s("27f9"),q=s("eebe"),y=s.n(q),O=Object(l["a"])(c,a,n,!1,null,null,null);e["default"]=O.exports;y()(O,"components",{QPage:d["a"],QSpinner:u["a"],QCard:p["a"],QCardSection:h["a"],QSeparator:g["a"],QCardActions:m["a"],QBtn:f["a"],QDialog:b["a"],QToolbar:k["a"],QToolbarTitle:_["a"],QSelect:v["a"],QMarkupTable:C["a"],QInput:w["a"]})}}]);