(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"184d":function(t,e,n){},3634:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{staticClass:"row items-center justify-center"},[n("div",{staticClass:"row q-pt-md q-pl-md text-weight-light"},[t.cashloading?n("q-spinner",{attrs:{color:"dark",size:"3em",thickness:2}}):t._e(),t._l(t.cashdesks,(function(e,s){return n("q-card",{key:s,staticClass:"q-mr-md q-mb-md",attrs:{flat:"",bordered:""}},[n("q-card-section",{attrs:{horizontal:""}},[n("q-card-section",{staticClass:"column justify-center"},[n("div",{staticClass:"text-h6"},[t._v("Caja "+t._s(e.id))]),n("div",[t._v(t._s(t.cashstates[e._state]))])]),n("q-separator",{attrs:{vertical:""}}),n("q-card-actions",{staticClass:"justify-around q-px-md",attrs:{vertical:""}},[e._state<3?[n("q-btn",{attrs:{flat:"",round:"",color:"primary",icon:"far fa-play-circle"},on:{click:function(e){return t.initOpening(s)}}})]:t._e(),3==e._state?[n("q-btn",{attrs:{flat:"",round:"",color:"red",icon:"fas fa-cut"},on:{click:function(e){return t.initCut(s)}}})]:t._e()],2)],1)],1)}))],2),n("q-dialog",{model:{value:t.wndOpening.state,callback:function(e){t.$set(t.wndOpening,"state",e)},expression:"wndOpening.state"}},[n("q-card",[n("q-toolbar",{staticClass:"bg-white text-dark"},[n("q-toolbar-title",[n("span",{staticClass:"text-weight-light"},[t._v(" Apertura de Caja "+t._s(t.wndOpening.cash?t.wndOpening.cash.id:""))])])],1),n("q-card-section",[n("div",{staticClass:"row"},[n("q-markup-table",{attrs:{flat:""}},t._l(t.bills,(function(e,s){return n("tr",{key:s+"_bill",staticClass:"text-indigo-5"},[n("td",[n("q-input",{attrs:{color:"dark",type:"number",min:"0","stack-label":"",label:"$ "+String(e.value)},model:{value:e.model,callback:function(n){t.$set(e,"model",n)},expression:"bill.model"}})],1)])})),0),n("q-markup-table",{attrs:{flat:""}},t._l(t.coins,(function(e,s){return n("tr",{key:s+"_coin"},[n("td",[n("q-input",{attrs:{color:"dark",type:"number",min:"0","stack-label":"",label:"$ "+String(e.value)},model:{value:e.model,callback:function(n){t.$set(e,"model",n)},expression:"coin.model"}})],1)])})),0)],1)]),t.totalCurrs?n("q-card-actions",{attrs:{align:"center"}},[n("q-btn",{attrs:{color:"dark",loading:t.wndOpening.opening},on:{click:t.makeOpening}},[t._v("Iniciar con $"+t._s(t.totalCurrs))])],1):t._e()],1)],1),n("q-dialog",{model:{value:t.wndCut.state,callback:function(e){t.$set(t.wndCut,"state",e)},expression:"wndCut.state"}},[n("q-card",[n("q-toolbar",{staticClass:"bg-white text-dark"},[n("q-toolbar-title",[n("span",{staticClass:"text-weight-light"},[t._v(" Corte de Caja "+t._s(t.wndCut.cash?t.wndCut.cash.id:""))])])],1),n("q-card-section",[n("div",{staticClass:"row"},[n("q-markup-table",{attrs:{flat:""}},t._l(t.bills,(function(e,s){return n("tr",{key:s+"_bill",staticClass:"text-indigo-5"},[n("td",[n("q-input",{attrs:{color:"dark",type:"number",min:"0","stack-label":"",label:"$ "+String(e.value)},model:{value:e.model,callback:function(n){t.$set(e,"model",n)},expression:"bill.model"}})],1)])})),0),n("q-markup-table",{attrs:{flat:""}},t._l(t.coins,(function(e,s){return n("tr",{key:s+"_coin"},[n("td",[n("q-input",{attrs:{color:"dark",type:"number",min:"0","stack-label":"",label:"$ "+String(e.value)},model:{value:e.model,callback:function(n){t.$set(e,"model",n)},expression:"coin.model"}})],1)])})),0)],1)]),t.totalCurrs?n("q-card-actions",{attrs:{align:"center"}},[n("q-btn",{attrs:{color:"dark",loading:t.wndCut.cuting},on:{click:t.makeCut}},[t._v("Cerrar caja con: $"+t._s(t.totalCurrs))])],1):t._e()],1)],1)],1)},a=[],i=n("c973"),o=n.n(i),l=n("5671"),c={index(t){return console.log("%cIndexando Cashdesks...","font-size:2em; color:gold;"),console.log(t),l["a"].post("cashdesk/index",t).then(t=>(console.log(t),t.data)).catch(t=>{console.log("Hay un error importante"),console.log(t)})},newOpening(t){return console.log("%Apertudando Caja...","font-size:2em; color:gold;"),console.log(t),l["a"].post("cashdesk/opening",t)},makeCut(t){return console.log("%cHaciendo Corte...","font-size:2em; color:gold;"),console.log(t),l["a"].post("cashdesk/cut",t)}},r={data(){return{cashloading:!0,cashdesks:[],denomsdb:null,wndCut:{state:!1,cash:null,cuting:!1},wndOpening:{state:!1,cash:null,opening:!1},cashstates:{1:"Nueva/disponible para apertura",2:"Disponible para apertura",3:"En uso (cobrando)"}}},beforeMount(){this.index()},methods:{index(){var t=this;return o()((function*(){let e=yield c.index({apikey:t.apikey});t.cashdesks=e.cashdesks,t.denomsdb=e.currencies.map(t=>(t.model=0,t)),t.cashloading=!1}))()},initCut(t){this.wndCut.cash=this.cashdesks[t],this.wndCut.state=!0},initOpening(t){this.wndOpening.cash=this.cashdesks[t],this.wndOpening.state=!0},resetwndCut(){this.wndCut.cash=null,this.wndCut.state=!1,this.wndCut.cuting=!1},resetwndOpening(){this.wndOpening.cash=null,this.wndOpening.state=!1,this.wndOpening.opening=!1},makeCut(){console.log("cutcash starts");let t=this.denomsdb.map(t=>({id:t.id,cant:parseInt(t.model)})),e={apikey:this.apikey,cashdesk:{id:this.wndCut.cash.id,denoms:t,assignedto:3,notes:""}};this.wndCut.cuting=!0,c.makeCut(e).then(t=>{let e=t.data;console.log(e),this.$q.notify({color:"positive",message:`Corte ${e.resume.cut.id} concretado!!`,icon:"done"});let n=this.cashdesks.findIndex(t=>t.id==this.wndCut.cash.id);this.cashdesks[n]._state=2,this.resetwndCut()}).catch(t=>{console.log(t)})},makeOpening(){console.log("opening starts");let t=this.denomsdb.map(t=>({id:t.id,cant:parseInt(t.model)}));console.log(this.wndOpening.cash.id);let e={apikey:this.apikey,cashdesk:{id:this.wndOpening.cash.id,denoms:t,assignto:3,notes:""}};this.wndOpening.opening=!0,c.newOpening(e).then(t=>{let e=t.data;if(console.log(e),e){this.wndOpening.state=!1;let t=this.cashdesks.findIndex(t=>t.id==this.wndOpening.cash.id);this.cashdesks[t]._state=3,this.$q.notify({color:"positive",message:`Listo!! (${e.rset.openid})`,icon:"done"}),this.resetwndOpening()}}).catch(t=>{console.log(t)})}},computed:{apikey(){return this.$store.state.account.apikey},bills(){if(this.denomsdb)return this.denomsdb.filter(t=>1==t.type)},coins(){if(this.denomsdb)return this.denomsdb.filter(t=>2==t.type)},totalCurrs(){if(this.denomsdb){let t=this.coins.map(t=>t.value*t.model).reduce((t,e)=>t+e)+this.bills.map(t=>t.value*t.model).reduce((t,e)=>t+e);return t}return 0}}},d=r,u=(n("935e"),n("2877")),p=n("9989"),h=n("0d59"),g=n("f09f"),m=n("a370"),b=n("eb85"),k=n("4b7e"),C=n("9c40"),w=n("24e8"),f=n("65c6"),q=n("6ac5"),_=n("2bb1"),v=n("27f9"),y=n("eebe"),O=n.n(y),x=Object(u["a"])(d,s,a,!1,null,null,null);e["default"]=x.exports;O()(x,"components",{QPage:p["a"],QSpinner:h["a"],QCard:g["a"],QCardSection:m["a"],QSeparator:b["a"],QCardActions:k["a"],QBtn:C["a"],QDialog:w["a"],QToolbar:f["a"],QToolbarTitle:q["a"],QMarkupTable:_["a"],QInput:v["a"]})},"935e":function(t,e,n){"use strict";var s=n("184d"),a=n.n(s);a.a}}]);